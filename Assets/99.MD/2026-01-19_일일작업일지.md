# 2026-01-19 일일 작업 일지

## 📅 작업 개요
*   **작성자**: Gemini Agent
*   **날짜**: 2026년 1월 19일 월요일
*   **프로젝트**: 3D Vampire Survivor Like

## 📝 주요 작업 내용

### 1. HexGridRenderer 시스템 고도화
배경 장식용이었던 `HexGridRenderer`를 게임플레이 로직의 핵심 요소로 확장하였습니다.
*   **그리드 모드 분리**: 배경용(`Background`)과 무기 범위 표시용(`AoE`)으로 모드를 분리하여 범용성을 확보함.
*   **좌표계 변환 구현**:
    *   World Position ↔ Offset Coordinate ↔ Cube Coordinate 변환 로직 구현.
    *   물리적 거리(Radius)가 아닌 논리적 거리(Hex Count) 기반의 정확한 범위 판정 시스템 구축.
*   **적 감지 기능 (ScanTargets)**:
    *   `Physics.OverlapSphere`로 1차 필터링 후, 육각형 거리 공식으로 2차 정밀 필터링을 수행하는 로직 구현.
*   **차징(Charging) 이펙트**:
    *   비동기(시간 지연) 공격을 시각화하는 기능 추가.
    *   테두리에서 중앙으로 색이 차오르는(Border-to-Center) 애니메이션 구현.
    *   `Cube Loop` 알고리즘을 적용하여 범위 내 타일 누락 문제 해결.

### 2. AoEWeapon 버그 수정
*   **문제**: 인스펙터에서 설정한 `AreaOfEffectRadius` 값이 게임 시작 시 무조건 `5.0`으로 초기화되는 현상 발생.
*   **원인**: `WeaponSettingLogic`에서 `baseStats`를 `new` 키워드로 무조건 재생성하여 기존 데이터를 덮어씀.
*   **해결**: 이미 데이터가 존재할 경우(`null`이 아닐 경우) 재생성하지 않도록 예외 처리 추가.

### 3. 렌더링 이슈 해결
*   **문제**: Shapes 그리드가 UI나 다른 투명 이펙트와 겹치거나 가려지는 현상.
*   **해결**: 
    *   `RenderPassEvent`와 `ZTest` 설정을 인스펙터에 노출.
    *   차징 이펙트의 경우 `CompareFunction.Always`를 적용하고 Y Offset을 높여 시인성 확보.

---

## 💡 문제 해결 및 배운 점 (Technical Notes)

### 육각형 그리드 순회 (Offset vs Cube)
*   **문제점**: 초기에는 `Offset Coordinate`(2차원 배열 방식)로 루프를 돌며 거리를 체크했으나, 육각형의 지그재그 배치 특성상 대각선 방향이나 거리 0, 1인 타일이 루프 범위에서 누락되는 문제가 발생함.
*   **해결책**: `Cube Coordinate`(3축 대각선 좌표계)를 기준으로 루프를 도는 알고리즘으로 변경.
    *   `q`와 `r` 축을 이용하여 중심으로부터 정확히 N칸 거리 내의 모든 타일을 수학적으로 완벽하게 순회함.
    *   이를 통해 차징 이펙트가 빈 곳 없이 깔끔하게 렌더링됨.

### Shapes의 Immediate Mode 시각 효과
*   **구현**: "테두리에서 중앙으로 채워지는 효과"를 구현하기 위해 `Draw.RegularPolygonBorder`를 활용.
*   **테크닉**: 
    *   `Thickness`를 0에서 `HexRadius`까지 증가시킴.
    *   동시에 `Radius`를 `HexRadius - (Thickness / 2)`로 보정하여, 외곽선의 바깥쪽 끝을 고정시킨 채 안쪽으로만 두께가 늘어나도록 연출함.

## 🔜 다음 계획
*   적(Monster)에게 해당 HexGrid 시스템을 적용하여 타일 기반 이동 로직 실험.
*   다양한 패턴의 장판 공격(부채꼴, 직선형) 구현 고려.
