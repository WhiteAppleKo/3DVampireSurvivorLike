# 2025-12-24 일일 작업 일지

## 오늘 한 일
1. **증강 시스템 분석 및 문서화**
   - `IAugment` 인터페이스와 `Weapon` 클래스 간의 스탯 재계산 로직 분석.
   - 신규 증강 추가를 위한 [기술문서] 작성 완료.

2. **육각형 그리드 시스템 구현**
   - **에디터용 도구**: `HexGridGenerator`를 통해 에디터에서 사각형/중앙 정렬 방식으로 벌집 모양 필드를 배치하는 도구 제작.
   - **실시간 렌더러**: Shapes 에셋을 활용해 플레이어 주변에 실시간으로 네온 육각형 그리드를 그리는 `HexGridRenderer` 구현.

3. **Shapes 에셋 최적화 및 시각화 개선**
   - HDR 컬러(`[ColorUsage]`)를 적용하여 네온 효과 구현.
   - 메인 선과 외곽선(Outline)을 분리하여 시인성 확보.

## 핵심 이슈: 렌더링 덮어쓰기 문제 (Z-Fighting 및 가림 현상)

### 1. 문제 상황
- `HexGridRenderer`가 그린 육각형 그리드가 캐릭터(불투명 오브젝트) 위에 덮여서 그려짐.
- 결과적으로 캐릭터가 그리드 선에 가려져 보이지 않거나, 발밑이 아닌 발등 위로 선이 지나가는 현상 발생.

### 2. 원인 분석
- **Immediate Mode 렌더링 시점**: Shapes의 즉시 모드 드로잉 명령이 카메라의 불투명 패스(Opaque Pass)보다 나중에, 혹은 깊이 버퍼(Depth Buffer)를 무시하는 시점에 실행됨.
- **깊이 테스트(ZTest) 부재**: 그리드가 그려질 때 이미 그려진 캐릭터의 깊이 값을 확인하지 않아 "누가 앞에 있는지"를 판별하지 못함.

### 3. 해결 방법
- **RenderPassEvent 지정**: `Draw.Command(cam, RenderPassEvent.BeforeRenderingTransparents)`를 사용하여, 캐릭터(불투명)가 모두 그려진 직후이자 투명 물체가 그려지기 전의 시점에 그리드를 그리도록 강제함. 이 시점에는 캐릭터의 깊이 정보가 살아있음.
- **ZTest 활성화**: `Draw.ZTest = CompareFunction.LessEqual`을 설정하여, 이미 그려진 물체(캐릭터)보다 깊이 값이 뒤에 있을 경우에만 선을 그리도록 수정.
- **Y-Offset 및 레이어링**: 
  - `yOffset`을 캐릭터 발바닥 높이(0.01f)로 설정.
  - 테두리(Outline)를 메인 선보다 0.001f 더 낮게 그려 Z-Fighting(깜빡임) 방지.

## 내일 할 일
- 육각형 타일별 속성(속도 저하, 데미지 구역 등)을 부여할 수 있는 데이터 구조 설계.
- 몬스터 AI가 육각형 그리드 좌표를 인식하여 이동하는 기능 검토.
