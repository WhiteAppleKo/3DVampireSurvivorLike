# 2025-12-26 (금) 일일 작업 일지

## 1. 주요 작업 내용

### 🎨 UI / Shapes (IMCanvas)
*   **테두리 렌더링 오차 수정**: `IMCanvas`에서 `Draw.RectangleBorder` 사용 시, 선의 두께(Thickness) 절반이 화면 밖으로 나가 잘리는 현상을 발견했습니다.
    *   **해결**: `Rect.Inflate(-thickness / 2f)`를 사용하여 사각형 영역을 안쪽으로 미세하게 축소한 뒤 그리는 방식으로 수정하여, 모든 기기 해상도에서 테두리가 화면 끝에 정확히 맞도록 개선했습니다.

### 🔗 시스템 아키텍처 (Data Binding)
*   **HP 데이터 바인딩 구조 개선**: `ClampInt` 데이터를 UI에 연결하는 방식에 대해 논의했습니다.
    *   기존의 직접 참조(`public Controller`) 방식과 잘못된 형변환(`Invalid Cast`) 문제를 확인했습니다.
    *   **해결책 도출**: `ClampValue<T>`에 이미 구현된 **Observer 패턴(`Events.Callback`)**을 활용하기로 결정했습니다.
    *   UI가 데이터를 직접 소유하지 않고, 매니저를 통해 주입받는(Dependency Injection) 형태로 결합도를 낮추는 방향으로 설계를 구체화했습니다.

### 🐛 버그 수정 (Debugging)
*   **PlayerController 초기화 오류**:
    *   증상: `UIManager`에서 `NullReferenceException` 발생 및 데미지 피격 이벤트 미작동.
    *   원인: `PlayerController`가 `Awake`, `OnEnable`, `OnDisable`을 오버라이드하면서 `base.Method()`를 호출하지 않아, 부모 클래스(`Controller`)의 HP 초기화 및 이벤트 구독 코드가 실행되지 않음.
    *   **해결**: `PlayerController`의 생명주기 함수에 `base` 호출을 추가하여 정상화했습니다.

---

## 2. 발생했던 문제 (Issues) & 해결 (Solutions)

| 구분 | 문제 현상 | 원인 분석 | 해결 방법 |
| :--- | :--- | :--- | :--- |
| **UI** | 테두리 일부가 화면 밖으로 잘림 | Shapes의 Border는 선의 중심(Center)을 기준으로 그려짐 | `Inflate` 함수로 두께의 절반만큼 Rect 안쪽으로 수축 |
| **Code** | `NullReferenceException` & 피격 무시 | `PlayerController`에서 `base.Awake()` 누락으로 `hp`가 null 상태 & 이벤트 구독 안 함 | `PlayerController` 스크립트에 `base` 호출 추가 |
| **Design** | `InvalidCastException` (DataBindManager) | MonoBehaviour를 구조체로 강제 형변환 시도 | 인터페이스(`IBindable`) 활용 및 의존성 주입 패턴으로 구조 변경 제안 |

---

## 3. 내일 할 일 (Next Steps)
*   [ ] 수정된 `DataBindManager` 또는 `BindHP` 패턴을 실제 프로젝트에 적용하여 HP바 연동 완료.
*   [ ] 플레이어 피격 및 사망 로직 테스트.
*   [ ] Shapes 에셋을 활용한 추가 UI 연출(데미지 피드백 등) 구현.

---

## 4. 메모
*   **ClampValue 활용**: `ClampInt` 등에는 이미 강력한 이벤트 시스템(`onValueChanged`, `onMinReached` 등)이 내장되어 있으므로, 불필요한 `Action` 추가 없이 이를 적극 활용하자.
*   **상속의 기본**: 자식 클래스에서 생명주기 함수(`Awake`, `Start` 등)를 재정의할 때는 반드시 부모의 초기화 로직이 필요한지(`base` 호출) 확인해야 한다.
