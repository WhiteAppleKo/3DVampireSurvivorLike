# 2025-12-30 일일 작업 일지

## 1. 작업 내역

### BaseStats 구조 개선 및 에디터 확장
*   **PlayerStats 선택적 사용 기능 추가**: `BaseStats` 클래스에 `usePlayerStats` bool 변수를 추가하여, `PlayerStats`의 사용 여부를 인스펙터에서 제어할 수 있도록 구조 변경.
*   **커스텀 프로퍼티 드로어(Custom Property Drawer) 제작**:
    *   `BaseStatsDrawer` 스크립트를 작성하여 인스펙터 UI 커스터마이징.
    *   `usePlayerStats` 체크 해제 시, `PlayerStats` 필드를 숨기는 대신 **비활성화(Disabled Group)** 처리하여 내용은 보이지만 수정할 수 없는 상태(Read-only)로 표시되도록 UX 개선.
*   **직렬화(Serialization) 보완**: `ClampValue<T>` 및 `ClampInt` 클래스에 `[Serializable]` 속성이 누락되어 인스펙터에 노출되지 않던 문제를 수정.

### 버그 수정 및 안정성 확보
*   **초기화 순서 문제 해결**: `PlayerController`의 `Awake`에서 `base.Awake()`가 `playerStats` 할당보다 먼저 실행되어 `FinalStats`에 데이터가 반영되지 않던 문제를 수정 (할당 후 부모 `Awake` 호출).
*   **NullReferenceException 방어**:
    *   `PlayerStats` 복사 생성자: 원본 객체나 내부 필드(`exp`)가 `null`일 경우에 대한 예외 처리 추가.
    *   `UIManager`: 이벤트 구독(`SubScribe`) 시 `usePlayerStats` 플래그와 `playerStats` null 여부를 확인하도록 수정.

## 2. 배운 점
*   **Editor Scripting**: `EditorGUI.BeginDisabledGroup(bool)`을 사용하면 특정 UI 그룹을 쉽게 비활성화(회색 처리)할 수 있음을 확인. 이를 통해 데이터를 숨기지 않고도 수정 불가능 상태임을 명확히 전달할 수 있음.
*   **객체 초기화 순서**: 상속 관계가 있는 클래스(`Controller` -> `PlayerController`)에서 `base.Awake()` 내부 로직이 자식 클래스의 필드에 의존할 경우, 반드시 자식 필드를 먼저 초기화해야 함을 재확인.

## 3. 발생한 문제점 및 해결

### 문제 1: 인스펙터 커스텀 중 NullReferenceException
*   **상황**: `BaseStatsDrawer`에서 프로퍼티 높이를 계산하거나 필드를 찾을 때 `NullReferenceException` 발생.
*   **원인**: `FindPropertyRelative`가 찾지 못한 프로퍼티에 접근하거나, 직렬화되지 않은 클래스(`ClampInt`)를 그리려 시도함.
*   **해결**: `ClampInt`에 `[Serializable]`을 추가하고, 드로어 스크립트에서 프로퍼티가 `null`인 경우 안전하게 무시하거나 높이를 0으로 처리하도록 방어 코드 작성.

### 문제 2: 게임 실행 즉시 크래시 (NullReference)
*   **상황**: 게임 시작 시 `UIManager`와 `PlayerController`에서 에러 발생.
*   **원인**:
    1.  `FinalStats` 생성 시점에는 `playerStats`가 `null`이었음 (얕은 복사/초기화 순서 문제).
    2.  `UIManager`는 `playerStats`가 없을 때도 구독을 시도함.
*   **해결**: `PlayerController`의 초기화 순서를 변경하고, `PlayerStats` 복사 생성자에 깊은 복사 및 Null 체크 로직을 추가하여 해결.
