# 2025-12-29 일일 작업 일지

## 오늘 한 일
- **인스펙터 노출 문제 분석**: `BaseStats` 내의 `ClampInt`가 인스펙터에 보이지 않는 원인이 클래스 직렬화(`[Serializable]`) 누락 및 자동 구현 프로퍼티 사용임을 확인.
- **C# 생성자 규칙 검토**: 복사 생성자 정의 시 기본 생성자가 자동 생성되지 않는 규칙과 유니티 직렬화를 위한 명시적 선언의 필요성 확인.
- **깊은 복사(Deep Copy) 이슈 지적**: `BaseStats` 복사 생성자에서 클래스 타입(`ClampInt`)을 단순 대입할 경우 발생하는 참조 공유(얕은 복사) 문제와 해결 방법 제시.
- **런타임 에러 분석**: `Controller.Awake()`에서 `FinalStats` 객체 생성 전 멤버에 접근하여 발생하는 `NullReferenceException` 원인 파악.
- **Shapes 에셋 분석**: `Draw.Text` 함수의 인자 구성을 통해 폰트 및 폰트 사이즈가 설정되는 위치 확인.
- **싱글톤 부활(Resurrection) 및 NullRef 에러 해결**:
    - 앱 종료 시 `UIManager` 인스턴스가 파괴된 후 다른 오브젝트의 `OnDisable`에서 이를 다시 호출하여 발생하는 "Some objects were not cleaned up" 경고 및 `NullReferenceException` 해결.
    - **SingletoneBase.cs 핵심 수정**:
        - `public static bool isApplicationQuitting` 변수를 노출하여 외부에서 앱 종료 상태를 즉시 확인 가능하도록 변경.
        - **`HasInstance` 프로퍼티 도입**: `m_Instance != null` 여부만 반환하는 프로퍼티를 추가. 기존 `Instance` 프로퍼티는 호출 시 인스턴스가 없으면 새로 생성(Lazy Initialization)하지만, `HasInstance`는 새로운 오브젝트 생성(부활) 없이 존재 여부만 안전하게 체크함.
- **UI 스크립트 안정화**:
    - `PlayerHPInLine.cs`, `CircleEXP.cs`, `IMEXPPanel.cs`의 `OnDisable` 로직 개선.
    - `isApplicationQuitting`과 `HasInstance`를 순차적으로 체크하여, 앱 종료 중이거나 매니저가 이미 파괴된 경우 `Instance`에 접근하지 않도록 방어 코드 작성.
- **Shapes 에셋 제어 기능 구현**:
    - `PlayerHPInLine.cs`에서 코드로 `Shapes.Disc`의 각도를 직접 제어하는 로직 추가.
    - `m_HpDisc.AngRadiansEnd = ratio * Mathf.PI * 2f;`를 통해 체력 비율에 맞춰 원형 게이지가 시각적으로 차오르는 기능 구현.

## 현재 직면한 문제점
- `Controller` 초기화 로직의 결함으로 인해 게임 실행 시 `NullReferenceException`이 발생하여 테스트가 중단됨.
- 주요 데이터 클래스(`ClampInt` 등)가 인스펙터에 나타나지 않아 에디터에서의 수치 제어가 불가능함.
- (해결됨) 싱글톤 생명주기 문제로 인해 앱 종료 시 발생하던 좀비 오브젝트 생성 문제 및 런타임 경고 해결.