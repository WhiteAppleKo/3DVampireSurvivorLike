### 2025년 12월 12일 일일 작업 일지

#### 오늘 한 일 (Tasks Completed)

1.  **투사체 화면 이탈 감지 로직 개선**
    *   기존 `Renderer.isVisible` 방식이 에디터의 Scene 뷰에 영향을 받는 문제를 파악하고, `Camera.WorldToViewportPoint`를 사용하는 방식으로 로직을 교체하여 정확도를 높였습니다.

2.  **전투 시스템 아키텍처 설계**
    *   오브젝트 간 직접 참조 방식과 `BattleManager`를 이용한 이벤트 기반 방식을 비교 분석했습니다.
    *   확장성과 유지보수를 위해 `BattleManager`를 중재자로 두는 이벤트 기반 아키텍처를 채택했습니다.

3.  **범용 싱글톤 베이스 클래스(`SingletoneBase`) 구현 및 고도화**
    *   상속하여 사용할 수 있는 제네릭 싱글톤 클래스 `SingletoneBase<T>`를 구현했습니다.
    *   씬 종료 시 싱글톤이 재생성되며 발생하는 에러를 `OnApplicationQuit` 이벤트 함수와 `static` 플래그를 사용하여 해결했습니다.

4.  **투사체 데미지 시스템 디버깅**
    *   `Projectile`이 `Enemy`에게 데미지를 주지 못하는 현상을 분석했습니다.
    *   원인이 `Projectile.cs`의 `OnTriggerEnter` 내 `struct` 초기화 문법 오류로 인한 컴파일 에러임을 찾아냈습니다.
    *   `EnemyController`가 부모 클래스인 `Controller`를 통해 이벤트를 정상적으로 구독하고 있음을 확인했습니다.

#### 학습한 내용 (Learnings)

*   **`Renderer.isVisible` vs. `Camera.WorldToViewportPoint`**: `isVisible`은 모든 카메라(Scene 뷰 포함)에 영향을 받으며, `WorldToViewportPoint`는 특정 카메라 기준의 화면 비율 좌표를 제공하여 더 명확한 로직을 짤 수 있음을 이해했습니다.
*   **이벤트 기반 아키텍처 (Mediator/Observer Pattern)**: 시스템 간의 결합도(Coupling)를 낮추는 것이 왜 중요한지, 그리고 이벤트 매니저가 어떻게 코드의 유연성과 확장성을 크게 향상시키는지 학습했습니다.
*   **견고한 싱글톤 패턴**: C#의 `lock`을 이용한 스레드 안전성 확보 방법과, `OnApplicationQuit`을 활용하여 유니티의 씬 종료 시점에서 발생하는 싱글톤 관련 에러를 방지하는 방법을 학습했습니다.
*   **디버깅 프로세스**: 문제가 발생했을 때, 데이터의 흐름(발사->충돌->이벤트->처리)을 따라가며 각 단계의 스크립트를 체계적으로 확인하여 문제의 근본 원인을 찾는 방법을 실습했습니다.
